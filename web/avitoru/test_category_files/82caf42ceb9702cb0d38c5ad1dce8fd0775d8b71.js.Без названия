var firebase=function(){var e=void 0===e?self:e;return function(t){function n(e){if(o[e])return o[e].exports;var r=o[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var r=e.webpackJsonpFirebase;e.webpackJsonpFirebase=function(e,o,s){for(var c,a,u,f=0,p=[];f<e.length;f++)a=e[f],i[a]&&p.push(i[a][0]),i[a]=0;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&(t[c]=o[c]);for(r&&r(e,o,s);p.length;)p.shift()();if(s)for(f=0;f<s.length;f++)u=n(n.s=s[f]);return u};var o={},i={4:0};return n.e=function(e){function t(){c.onerror=c.onload=null,clearTimeout(a);var t=i[e];0!==t&&(t&&t[1](Error("Loading chunk "+e+" failed.")),i[e]=void 0)}var r=i[e];if(0===r)return new Promise(function(e){e()});if(r)return r[2];var o=new Promise(function(t,n){r=i[e]=[t,n]});r[2]=o;var s=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.async=!0,c.timeout=12e4,n.nc&&c.setAttribute("nonce",n.nc),c.src=n.p+""+e+".js";var a=setTimeout(t,12e4);return c.onerror=c.onload=t,s.appendChild(c),o},n.m=t,n.c=o,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n.oe=function(e){throw console.error(e),e},n(n.s=9)}({24:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r="FirebaseError",o=Error.captureStackTrace,i=function(){return function(e,t){if(this.code=e,this.message=t,o)o(this,s.prototype.create);else{var n=Error.apply(this,arguments);this.name=r,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}}();i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i.prototype.name=r;var s=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,t){void 0===t&&(t={});var n,r=this.errors[e],o=this.service+"/"+e;n=void 0===r?"Error":r.replace(this.pattern,function(e,n){var r=t[n];return void 0!==r?""+r:"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+o+").";var s=new i(o,n);for(var c in t)t.hasOwnProperty(c)&&"_"!==c.slice(-1)&&(s[c]=t[c]);return s},e}()},3:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i});var r=n(32).a.Promise||n(57),o=function(){function e(){var e=this;this.resolve=null,this.reject=null,this.promise=new r(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(i(t.promise),1===e.length?e(n):e(n,r))}},e}(),i=function(e){e.catch(function(){})}},31:function(e,t,n){"use strict";function r(e,t){if("object"!==(void 0===e?"undefined":s(e))||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o in e&&"function"==typeof e[o])return!0}return!1}function o(){}t.a=function(e,t){var n=new c(e,t);return n.subscribe.bind(n)};var i=n(3),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=i.b.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var i,s=this;if(void 0===e&&void 0===t&&void 0===n)throw Error("Missing Observer.");void 0===(i=r(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(i.next=o),void 0===i.error&&(i.error=o),void 0===i.complete&&(i.complete=o);var c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{s.finalError?i.error(s.finalError):i.complete()}catch(e){}}),this.observers.push(i),c},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}()},32:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var r;if(void 0!==e)r=e;else if("undefined"!=typeof self)r=self;else try{r=Function("return this")()}catch(e){throw Error("polyfill failed because global object is unavailable in this environment")}var o=r}).call(t,n(33))},33:function(t,n){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof e&&(r=e)}t.exports=r},34:function(e,t){function n(){throw Error("setTimeout has not been defined")}function r(){throw Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(p===clearTimeout)return clearTimeout(e);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function s(){v&&h&&(v=!1,h.length?d=h.concat(d):b=-1,d.length&&c())}function c(){if(!v){var e=o(s);v=!0;for(var t=d.length;t;){for(h=d,d=[];++b<t;)h&&h[b].run();b=-1,t=d.length}h=null,v=!1,i(e)}}function a(e,t){this.fun=e,this.array=t}function u(){}var f,p,l=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{p="function"==typeof clearTimeout?clearTimeout:r}catch(e){p=r}}();var h,d=[],v=!1,b=-1;l.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new a(e,t)),1!==d.length||v||o(c)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(e){return[]},l.binding=function(e){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},35:function(e,t,n){"use strict";function r(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var o in t)t.hasOwnProperty(o)&&(e[o]=r(e[o],t[o]));return e}t.a=function(e){return r(void 0,e)},t.b=r,t.c=function(e,t,n){e[t]=n}},56:function(e,t){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return o;o++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o++}}})},57:function(e,t,n){(function(t){!function(n){function r(){}function o(e,t){return function(){e.apply(t,arguments)}}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this.t=0,this.r=!1,this.u=void 0,this.f=[],p(e,this)}function s(e,t){for(;3===e.t;)e=e.u;0!==e.t?(e.r=!0,i.h(function(){var n=1===e.t?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e.u)}catch(e){return void a(t.promise,e)}c(t.promise,r)}else(1===e.t?c:a)(t.promise,e.u)})):e.f.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e.t=3,e.u=t,void u(e);if("function"==typeof n)return void p(o(n,t),e)}e.t=1,e.u=t,u(e)}catch(t){a(e,t)}}function a(e,t){e.t=2,e.u=t,u(e)}function u(e){2===e.t&&0===e.f.length&&i.h(function(){e.r||i.v(e.u)});for(var t=0,n=e.f.length;t<n;t++)s(e,e.f[t]);e.f=null}function f(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function p(e,t){var n=!1;try{e(function(e){n||(n=!0,c(t,e))},function(e){n||(n=!0,a(t,e))})}catch(e){if(n)return;n=!0,a(t,e)}}var l=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return s(this,new f(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function r(i,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var c=s.then;if("function"==typeof c)return void c.call(s,function(e){r(i,e)},n)}t[i]=s,0==--o&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var o=t.length,i=0;i<t.length;i++)r(i,t[i])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},i.h="function"==typeof t&&function(e){t(e)}||function(e){l(e,0)},i.v=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i.y=function(e){i.h=e},i._=function(e){i.v=e},void 0!==e&&e.exports?e.exports=i:n.Promise||(n.Promise=i)}(this)}).call(t,n(58).setImmediate)},58:function(t,n,r){function o(e,t){this.g=e,this.T=t}var i=Function.prototype.apply;n.setTimeout=function(){return new o(i.call(setTimeout,e,arguments),clearTimeout)},n.setInterval=function(){return new o(i.call(setInterval,e,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this.T.call(e,this.g)},n.enroll=function(e,t){clearTimeout(e.w),e.O=t},n.unenroll=function(e){clearTimeout(e.w),e.O=-1},n.j=n.active=function(e){clearTimeout(e.w);var t=e.O;t>=0&&(e.w=setTimeout(function(){e.A&&e.A()},t))},r(59),n.setImmediate=setImmediate,n.clearImmediate=clearImmediate},59:function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){delete a[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function i(e){if(u)setTimeout(i,0,e);else{var t=a[e];if(t){u=!0;try{o(t)}finally{r(e),u=!1}}}}if(!e.setImmediate){var s,c=1,a={},u=!1,f=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?s=function(e){t.nextTick(function(){i(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&i(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){i(e.data)},s=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;s=function(t){var n=f.createElement("script");n.onreadystatechange=function(){i(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():s=function(e){setTimeout(i,0,e)},p.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var t=Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return a[c]=r,s(c),c++},p.clearImmediate=r}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(33),n(34))},9:function(e,t,n){"use strict";function r(){function e(e){return e=e||f,u(h,e)||o("no-app",{name:e}),h[e]}function t(){return Object.keys(h).map(function(e){return h[e]})}function n(e,t){Object.keys(d).forEach(function(n){var r=p(e,n);null!==r&&v[r]&&v[r](t,e)})}function p(e,t){if("serverAuth"===t)return null;var n=t;return e.options,n}var h={},d={},v={},b={__esModule:!0,initializeApp:function(e,t){void 0===t?t=f:"string"==typeof t&&""!==t||o("bad-app-name",{name:t+""}),u(h,t)&&o("duplicate-app",{name:t});var r=new l(e,t,b);return h[t]=r,n(r,"create"),r},app:e,apps:null,Promise:c.b,SDK_VERSION:"4.5.0",INTERNAL:{registerService:function(n,r,i,s,c){d[n]&&o("duplicate-service",{name:n}),d[n]=r,s&&(v[n]=s,t().forEach(function(e){s("create",e)}));var u=function(t){return void 0===t&&(t=e()),"function"!=typeof t[n]&&o("invalid-app-argument",{name:n}),t[n]()};return void 0!==i&&Object(a.b)(u,i),b[n]=u,l.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.k.bind(this,n).apply(this,c?e:[])},u},createFirebaseNamespace:r,extendNamespace:function(e){Object(a.b)(b,e)},createSubscribe:i.a,ErrorFactory:s.a,removeApp:function(e){n(h[e],"delete"),delete h[e]},factories:d,useAsService:p,Promise:c.b,deepExtend:a.b}};return Object(a.c)(b,"default",b),Object.defineProperty(b,"apps",{get:t}),Object(a.c)(e,"App",l),b}function o(e,t){throw d.create(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var i=(n(56),n(31)),s=n(24),c=n(3),a=n(35),u=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},f="[DEFAULT]",p=[],l=function(){function e(e,t,n){this.I=n,this.F=!1,this.N={},this.x=t,this.P=Object(a.a)(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return c.b.resolve(null)},addAuthTokenListener:function(e){p.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){p=p.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.L(),this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.L(),this.P},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new c.b(function(t){e.L(),t()}).then(function(){e.I.INTERNAL.removeApp(e.x);var t=[];return Object.keys(e.N).forEach(function(n){Object.keys(e.N[n]).forEach(function(r){t.push(e.N[n][r])})}),c.b.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.F=!0,e.N={}})},e.prototype.k=function(e,t){if(void 0===t&&(t=f),this.L(),this.N[e]||(this.N[e]={}),!this.N[e][t]){var n=t!==f?t:void 0,r=this.I.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.N[e][t]=r}return this.N[e][t]},e.prototype.extendApp=function(e){var t=this;Object(a.b)(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(p.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),p=[])},e.prototype.L=function(){this.F&&o("app-deleted",{name:this.x})},e}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var h={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},d=new s.a("app","Firebase",h),v=r();t.default=v}})}().default;try{webpackJsonpFirebase([3],{61:function(e,t,n){"use strict";function r(e){var t=new Uint8Array(e);return window.btoa(String.fromCharCode.apply(null,t))}function o(e){var t={Messaging:w};e.INTERNAL.registerService("messaging",function(e){return self&&"ServiceWorkerGlobalScope"in self?new S(e):new w(e)},t)}Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(24),c={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},a={codes:c,map:(i={},i[c.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[c.AVAILABLE_IN_SW]="This method is available in a service worker context.",i["should-be-overriden"]="This method should be overriden by extended classes.",i["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i["permission-default"]="The required permissions were not granted and dismissed instead.",i["permission-blocked"]="The required permissions were not granted and blocked instead.",i["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",i["notifications-blocked"]="Notifications have been blocked.",i[c.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i["sw-registration-expected"]="A service worker registration was the expected input.",i["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",i["invalid-saved-token"]="Unable to access details of the saved token.",i["sw-reg-redundant"]="The service worker being used for push was made redundant.",i["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$message}",i["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",i["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",i["use-sw-before-get-token"]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",i["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",i["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",i["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i["failed-to-delete-token"]="Unable to delete the currently saved token.",i["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i["bad-scope"]="The service worker scope must be a string with at least one character.",i["bad-vapid-key"]="The public VAPID key must be a string with at least one character.",i["bad-subscription"]="The subscription must be a valid PushSubscription.",i["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",i["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",i["failed-delete-vapid-key"]="The VAPID key could not be deleted.",i)},u=function(e){return r(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},f=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],p={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:f,SUBSCRIPTION_OPTIONS:{userVisibleOnly:!0,applicationServerKey:new Uint8Array(f)}},l="fcm_token_object_Store",h=function(){function e(){this.e=new s.a("messaging","Messaging",a.map),this.t=null}return e.prototype.r=function(){return this.t?this.t:(this.t=new Promise(function(e,t){var n=indexedDB.open("fcm_token_details_db",1);n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)},n.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(l,{keyPath:"swScope"});t.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),t.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.t)},e.prototype.closeDatabase=function(){var e=this;return this.t?this.t.then(function(t){t.close(),e.t=null}):Promise.resolve()},e.prototype.getTokenDetailsFromToken=function(e){return this.r().then(function(t){return new Promise(function(n,r){var o=t.transaction([l]).objectStore(l).index("fcmToken").get(e);o.onerror=function(e){r(e.target.error)},o.onsuccess=function(e){n(e.target.result)}})})},e.prototype.n=function(e){return this.r().then(function(t){return new Promise(function(n,r){var o=t.transaction([l]).objectStore(l).get(e);o.onerror=function(e){r(e.target.error)},o.onsuccess=function(e){n(e.target.result)}})})},e.prototype.o=function(e){return this.r().then(function(t){return new Promise(function(n,r){var o=[],i=t.transaction([l]).objectStore(l).openCursor();i.onerror=function(e){r(e.target.error)},i.onsuccess=function(t){var r=t.target.result;r?(r.value.fcmSenderId===e&&o.push(r.value),r.continue()):n(o)}})})},e.prototype.subscribeToFCM=function(e,t,n){var r=this,o=u(t.getKey("p256dh")),i=u(t.getKey("auth")),s="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+o+"&encryption_auth="+i;n&&(s+="&pushSet="+n);var c=new Headers;c.append("Content-Type","application/x-www-form-urlencoded");var f={method:"POST",headers:c,body:s};return fetch(p.ENDPOINT+"/fcm/connect/subscribe",f).then(function(e){return e.json()}).then(function(e){var t=e;if(t.error){var n=t.error.message;throw r.e.create(a.codes.TOKEN_SUBSCRIBE_FAILED,{message:n})}if(!t.token)throw r.e.create(a.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!t.pushSet)throw r.e.create(a.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:t.token,pushSet:t.pushSet}})},e.prototype.i=function(e,t){return e.endpoint===t.endpoint&&u(e.getKey("auth"))===t.auth&&u(e.getKey("p256dh"))===t.p256dh},e.prototype.s=function(e,t,n,r,o){var i={swScope:t.scope,endpoint:n.endpoint,auth:u(n.getKey("auth")),p256dh:u(n.getKey("p256dh")),fcmToken:r,fcmPushSet:o,fcmSenderId:e};return this.r().then(function(e){return new Promise(function(t,n){var r=e.transaction([l],"readwrite").objectStore(l).put(i);r.onerror=function(e){n(e.target.error)},r.onsuccess=function(e){t()}})})},e.prototype.getSavedToken=function(e,t){var n=this;return t instanceof ServiceWorkerRegistration?"string"!=typeof e||0===e.length?Promise.reject(this.e.create(a.codes.BAD_SENDER_ID)):this.o(e).then(function(n){if(0!==n.length){var r=n.findIndex(function(n){return t.scope===n.swScope&&e===n.fcmSenderId});if(-1!==r)return n[r]}}).then(function(e){if(e)return t.pushManager.getSubscription().catch(function(e){throw n.e.create(a.codes.GET_SUBSCRIPTION_FAILED)}).then(function(t){if(t&&n.i(t,e))return e.fcmToken})}):Promise.reject(this.e.create(a.codes.SW_REGISTRATION_EXPECTED))},e.prototype.createToken=function(e,t){var n=this;if("string"!=typeof e||0===e.length)return Promise.reject(this.e.create(a.codes.BAD_SENDER_ID));if(!(t instanceof ServiceWorkerRegistration))return Promise.reject(this.e.create(a.codes.SW_REGISTRATION_EXPECTED));var r,o;return t.pushManager.getSubscription().then(function(e){return e||t.pushManager.subscribe(p.SUBSCRIPTION_OPTIONS)}).then(function(t){return r=t,n.subscribeToFCM(e,r)}).then(function(i){return o=i,n.s(e,t,r,o.token,o.pushSet)}).then(function(){return o.token})},e.prototype.deleteToken=function(e){var t=this;return"string"!=typeof e||0===e.length?Promise.reject(this.e.create(a.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(e).then(function(e){if(!e)throw t.e.create(a.codes.DELETE_TOKEN_NOT_FOUND);return t.r().then(function(n){return new Promise(function(r,o){var i=n.transaction([l],"readwrite").objectStore(l).delete(e.swScope);i.onerror=function(e){o(e.target.error)},i.onsuccess=function(n){0!==n.target.result?r(e):o(t.e.create(a.codes.FAILED_TO_DELETE_TOKEN))}})})})},e}(),d="messagingSenderId",v=function(){function e(e){var t=this;if(this.e=new s.a("messaging","Messaging",a.map),!e.options[d]||"string"!=typeof e.options[d])throw this.e.create(a.codes.BAD_SENDER_ID);this.c=e.options[d],this.u=new h,this.app=e,this.INTERNAL={},this.INTERNAL.delete=function(){return t.delete}}return e.prototype.getToken=function(){var e=this,t=this._();return"granted"!==t?"denied"===t?Promise.reject(this.e.create(a.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this.f().then(function(t){return e.u.getSavedToken(e.c,t).then(function(n){return n||e.u.createToken(e.c,t)})})},e.prototype.deleteToken=function(e){var t=this;return this.u.deleteToken(e).then(function(){return t.f().then(function(e){if(e)return e.pushManager.getSubscription()}).then(function(e){if(e)return e.unsubscribe()})})},e.prototype.f=function(){throw this.e.create(a.codes.SHOULD_BE_INHERITED)},e.prototype.requestPermission=function(){throw this.e.create(a.codes.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw this.e.create(a.codes.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,n){throw this.e.create(a.codes.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,n){throw this.e.create(a.codes.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw this.e.create(a.codes.AVAILABLE_IN_SW)},e.prototype.delete=function(){this.u.closeDatabase()},e.prototype._=function(){return Notification.permission},e.prototype.getTokenManager=function(){return this.u},e}(),b={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},g={PARAMS:b,TYPES_OF_MSG:{PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},createNewMsg:function(e,t){return n={},n[b.TYPE_OF_MSG]=e,n[b.DATA]=t,n;var n}},m={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"},y=n(31),E=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),w=function(e){function t(t){var n=e.call(this,t)||this;return n.d,n.h,n.p=null,n.l=Object(y.a)(function(e){n.p=e}),n.g=null,n.S=Object(y.a)(function(e){n.g=e}),n.T(),n}return E(t,e),t.prototype.getToken=function(){var t=this;return this.b()?this.m().then(function(){return e.prototype.getToken.call(t)}):Promise.reject(this.e.create(a.codes.UNSUPPORTED_BROWSER))},t.prototype.m=function(){var e=this;if(this.h)return this.h;var t=document.querySelector('link[rel="manifest"]');return this.h=t?fetch(t.href).then(function(e){return e.json()}).catch(function(){return Promise.resolve()}).then(function(t){if(t&&t.gcm_sender_id&&"103953800507"!==t.gcm_sender_id)throw e.e.create(a.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.h},t.prototype.requestPermission=function(){var e=this;return"granted"===Notification.permission?Promise.resolve():new Promise(function(t,n){var r=function(r){return"granted"===r?t():n("denied"===r?e.e.create(a.codes.PERMISSION_BLOCKED):e.e.create(a.codes.PERMISSION_DEFAULT))},o=Notification.requestPermission(function(e){o||r(e)});o&&o.then(r)})},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw this.e.create(a.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.d)throw this.e.create(a.codes.USE_SW_BEFORE_GET_TOKEN);this.d=e},t.prototype.onMessage=function(e,t,n){return this.l(e,t,n)},t.prototype.onTokenRefresh=function(e,t,n){return this.S(e,t,n)},t.prototype.v=function(e){var t=this,n=e.installing||e.waiting||e.active;return new Promise(function(r,o){if(n)if("activated"!==n.state)if("redundant"!==n.state){n.addEventListener("statechange",function i(){if("activated"===n.state)r(e);else{if("redundant"!==n.state)return;o(t.e.create(a.codes.SW_REG_REDUNDANT))}n.removeEventListener("statechange",i)})}else o(t.e.create(a.codes.SW_REG_REDUNDANT));else r(e);else o(t.e.create(a.codes.NO_SW_IN_REG))})},t.prototype.f=function(){var e=this;return this.d?this.v(this.d):(this.d=null,navigator.serviceWorker.register(m.path,{scope:m.scope}).catch(function(t){throw e.e.create(a.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(t){return e.v(t).then(function(){return e.d=t,t.update(),t})}))},t.prototype.T=function(){var e=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[g.PARAMS.TYPE_OF_MSG]){var n=t.data;switch(n[g.PARAMS.TYPE_OF_MSG]){case g.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case g.TYPES_OF_MSG.NOTIFICATION_CLICKED:var r=n[g.PARAMS.DATA];e.p.next(r)}}},!1)},t.prototype.b=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},t}(v),_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(e){function t(t){var n=e.call(this,t)||this;return self.addEventListener("push",function(e){return n.I(e)},!1),self.addEventListener("pushsubscriptionchange",function(e){return n.y(e)},!1),self.addEventListener("notificationclick",function(e){return n.N(e)},!1),n.k=null,n}return T(t,e),t.prototype.I=function(e){var t,n=this;try{t=e.data.json()}catch(e){return}var r=this.w().then(function(e){if(e){if(t.notification||n.k)return n.O(t)}else{var r=n.D(t);if(r){var o=r.title||"";return self.registration.showNotification(o,r)}if(n.k)return n.k(t)}});e.waitUntil(r)},t.prototype.y=function(e){var t=this,n=this.getToken().then(function(e){if(!e)throw t.e.create(a.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var n=null,r=t.getTokenManager();return r.getTokenDetailsFromToken(e).then(function(e){if(!(n=e))throw t.e.create(a.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(p.SUBSCRIPTION_OPTIONS)}).then(function(e){return r.subscribeToFCM(n.fcmSenderId,e,n.fcmPushSet)}).catch(function(e){return r.deleteToken(n.fcmToken).then(function(){throw t.e.create(a.codes.UNABLE_TO_RESUBSCRIBE,{message:e})})})});e.waitUntil(n)},t.prototype.N=function(e){var t=this;if(e.notification&&e.notification.data&&e.notification.data.FCM_MSG){e.stopImmediatePropagation(),e.notification.close();var n=e.notification.data.FCM_MSG,r=n.notification.click_action;if(r){var o=this.A(r).then(function(e){return e||self.clients.openWindow(r)}).then(function(e){if(e){n.notification,delete n.notification;var r=g.createNewMsg(g.TYPES_OF_MSG.NOTIFICATION_CLICKED,n);return t.P(e,r)}});e.waitUntil(o)}}},t.prototype.D=function(e){if(e&&"object"===_(e.notification)){var t=Object.assign({},e.notification);return t.data=(n={},n.FCM_MSG=e,n),t;var n}},t.prototype.setBackgroundMessageHandler=function(e){if(e&&"function"!=typeof e)throw this.e.create(a.codes.BG_HANDLER_FUNCTION_EXPECTED);this.k=e},t.prototype.A=function(e){var t=new URL(e).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){for(var n=null,r=0;r<e.length;r++)if(new URL(e[r].url).href===t){n=e[r];break}if(n)return n.focus(),n})},t.prototype.P=function(e,t){var n=this;return new Promise(function(r,o){if(!e)return o(n.e.create(a.codes.NO_WINDOW_CLIENT_TO_MSG));e.postMessage(t),r()})},t.prototype.w=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(e){return e.some(function(e){return"visible"===e.visibilityState})})},t.prototype.O=function(e){var t=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){var r=g.createNewMsg(g.TYPES_OF_MSG.PUSH_MSG_RECEIVED,e);return Promise.all(n.map(function(e){return t.P(e,r)}))})},t.prototype.f=function(){return Promise.resolve(self.registration)},t}(v),O=n(9);t.registerMessaging=o,o(O.default)}},[61])}catch(e){throw Error("Cannot instantiate firebase-messaging.js - be sure to load firebase-app.js first.")}!function(){"use strict";function e(e){t(e)||fetch("/profile/token/save",{method:"post",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:e,platform:"firebase"})}).then(function(t){if(!t.ok||-1===t.headers.get("content-type").indexOf("application/json")){var r=new Error(t.statusText);throw r.responseOriginal=t,r}return n(e),t.json()}).catch(function(){r()})}function t(e){return window.localStorage.getItem(u)===e}function n(e){window.localStorage.setItem(u,e)}function r(){window.localStorage.removeItem(u)}function o(){return l.getToken().then(function(t){t?e(t):r()}).catch(function(){r()})}function i(){return l.requestPermission().then(function(){o()}).catch(function(e){console.warn("Не удалось получить разрешение на показ уведомлений.",e)})}function s(){var e=window.localStorage.getItem(u);return e?l.deleteToken(e).then(function(){r()}).catch(function(e){console.warn("Не удалось удалить токен.",e)}):Promise.resolve()}function c(e){var t=e.installing||e.waiting||e.active,n=new Error("SW успешно зарегистрирован, но по каким-то причинам недоступен"),r=new Error("SW не активен");return new Promise(function(o,i){if(t)if("activated"!==t.state)if("redundant"!==t.state){var s=function(){if("activated"===t.state)o(e);else{if("redundant"!==t.state)return;i(r)}t.removeEventListener("statechange",s)};t.addEventListener("statechange",s)}else i(r);else o(e);else i(n)})}function a(){var e={prompt:0,denied:0,granted:1};Boolean(window.localStorage.getItem(f))||fetch(p,{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:`eid=2682&version=2&browser_web_push_agreement=${e[this.state]}`})}var u="sent-push-token",f="web-push-subscribe-banner-logged",p="/events/add";if("https:"===window.location.protocol&&window.firebase&&navigator.serviceWorker&&window.PushManager&&window.Notification&&window.fetch&&window.ServiceWorkerRegistration&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&window.PushSubscription&&PushSubscription.prototype.hasOwnProperty("getKey")){firebase.initializeApp({messagingSenderId:"699005684910"});var l=firebase.messaging();"granted"===Notification.permission&&(window.avito.isAuthenticated?(i(),l.onMessage(function(e){console.log("Получено сообщение. ",e);var t=e.notification;"visible"===document.visibilityState&&t&&new URL(t.click_action).href!==window.location.href&&navigator.serviceWorker.register("/messaging-sw.js",{scope:"/local-messaging-push-scope"}).then(function(e){return c(e).then(function(){return t.data=t,e.update(),e.showNotification(t.title,t),e})}).catch(function(e){console.warn("Не удалось зарегистрировать SW",e)})})):s()),window.avito.isAuthenticated&&navigator.permissions.query({name:"notifications"}).then(function(e){e.onchange=function(){setTimeout(a.bind(this),50)}}),window.avito.firebaseMessaging={subscribe:i,unsubscribe:s}}}();