webpackJsonp([2],{10:function(e,t){e.exports=jQuery},125:function(e,t,i){"use strict";function s(e,t){return"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='"+e+"' height='"+t+"'%3E%3C/svg%3E"}function n(e){if(e.srcset&&!v&&window.picturefill){var t=window.picturefill._;e[t.ns]&&e[t.ns].evaled||t.fillImg(e,{reselect:!0}),e[t.ns].curSrc||(e[t.ns].supported=!1,t.fillImg(e,{reselect:!0})),e.currentSrc=e[t.ns].curSrc||e.src}}function a(e){for(var t,i=getComputedStyle(e).fontFamily,s={};null!==(t=u.exec(i));)s[t[1]]=t[2];return s}function r(e,t,i){var n=s(t||1,i||0);I.call(e,"src")!==n&&w.call(e,"src",n)}function o(e,t){e.naturalWidth?t(e):setTimeout(o,100,e,t)}function l(e){var t=a(e),i=e[d];if(t["object-fit"]=t["object-fit"]||"fill",!i.img){if("fill"===t["object-fit"])return;if(!i.skipTest&&f&&!t["object-position"])return}if(!i.img){i.img=new Image(e.width,e.height),i.img.srcset=I.call(e,"data-ofi-srcset")||e.srcset,i.img.src=I.call(e,"data-ofi-src")||e.src,w.call(e,"data-ofi-src",e.src),e.srcset&&w.call(e,"data-ofi-srcset",e.srcset),r(e,e.naturalWidth||e.width,e.naturalHeight||e.height),e.srcset&&(e.srcset="");try{c(e)}catch(e){window.console&&console.warn("https://bit.ly/ofi-old-browser")}}n(i.img),e.style.backgroundImage='url("'+(i.img.currentSrc||i.img.src).replace(/"/g,'\\"')+'")',e.style.backgroundPosition=t["object-position"]||"center",e.style.backgroundRepeat="no-repeat",e.style.backgroundOrigin="content-box",/scale-down/.test(t["object-fit"])?o(i.img,function(){i.img.naturalWidth>e.width||i.img.naturalHeight>e.height?e.style.backgroundSize="contain":e.style.backgroundSize="auto"}):e.style.backgroundSize=t["object-fit"].replace("none","auto").replace("fill","100% 100%"),o(i.img,function(t){r(e,t.naturalWidth,t.naturalHeight)})}function c(e){var t={get:function(t){return e[d].img[t||"src"]},set:function(t,i){return e[d].img[i||"src"]=t,w.call(e,"data-ofi-"+i,t),l(e),t}};Object.defineProperty(e,"src",t),Object.defineProperty(e,"currentSrc",{get:function(){return t.get("currentSrc")}}),Object.defineProperty(e,"srcset",{get:function(){return t.get("srcset")},set:function(e){return t.set(e,"srcset")}})}function h(e,t){var i=!b&&!e;if(t=t||{},e=e||"img",g&&!t.skipTest||!p)return!1;"img"===e?e=document.getElementsByTagName("img"):"string"==typeof e?e=document.querySelectorAll(e):"length"in e||(e=[e]);for(var s=0;s<e.length;s++)e[s][d]=e[s][d]||{skipTest:t.skipTest},l(e[s]);i&&(document.body.addEventListener("load",function(e){"IMG"===e.target.tagName&&h(e.target,{skipTest:t.skipTest})},!0),b=!0,e="img"),t.watchMQ&&window.addEventListener("resize",h.bind(null,e,{skipTest:t.skipTest}))}var d="bfred-it:object-fit-images",u=/(object-fit|object-position)\s*:\s*([-\w\s%]+)/g,m="undefined"==typeof Image?{style:{"object-position":1}}:new Image,f="object-fit"in m.style,g="object-position"in m.style,p="background-size"in m.style,v="string"==typeof m.currentSrc,I=m.getAttribute,w=m.setAttribute,b=!1;h.supportsObjectFit=f,h.supportsObjectPosition=g,function(){function e(e,t){return e[d]&&e[d].img&&("src"===t||"srcset"===t)?e[d].img:e}g||(HTMLImageElement.prototype.getAttribute=function(t){return I.call(e(this,t),t)},HTMLImageElement.prototype.setAttribute=function(t,i){return w.call(e(this,t),t,String(i))})}(),e.exports=h},126:function(e,t){},569:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(8),i(9),i(570),i(13),i(29),i(76),i(591)},570:function(e,t,i){"use strict";var s=(i(571),i(573),i(575)),n=i(579),a=i(588);$(function(){var e=$(".js-advertActionsButton");new n.a,new a.a,IRR.auth.userId&&IRR.auth.userId==e.data("owner_id")&&(new s.a,e.removeClass("hidden")),null!==$(".js-newBuilding").height()&&$(".js-contentPrice").css({paddingTop:"24px"})})},571:function(e,t,i){"use strict";var s=i(572);i.n(s)},572:function(e,t){},573:function(e,t,i){"use strict";var s=i(574);i.n(s)},574:function(e,t){},575:function(e,t,i){"use strict";var s=i(576),n=(i.n(s),i(577));i.d(t,"a",function(){return n.a})},576:function(e,t){},577:function(e,t,i){"use strict";var s=i(578);t.a=Backbone.View.extend({el:".js-openAdvertFinishPopup",events:{click:"openPopup"},initialize:function(){this.elements={$popupAdvertFinish:$(".js-popupAdertFinish").html()},this.modal=new IrrModalPrototype,this.modal.modalOptions.position="middle",this.view=null},openPopup:function(e){var t=this;e.preventDefault(),this.modal.open(),this.modal.setContent(this.elements.$popupAdvertFinish),this.view=new s.a;var i=this.view.$el.find(".js-modalCloseButton");return this.modal.on("afterClose",function(){i.off("click")}),this.modal.on("afterOpen",function(){i.on("click",function(){t.modal.close()})}),!1}})},578:function(e,t,i){"use strict";t.a=Backbone.View.extend({el:".js-advertFinish",events:{submit:"submitForm"},initialize:function(){this.elements={$submitButton:$(".js-advertFinishButton",this.el),advertId:advertId}},getCookie:function(e){var t=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return t?t[2]:""},submitForm:function(e){e.preventDefault();var t=this.elements,i=this.getCookie("puid"),s=this.$el.data("modalFinish").replace(/%advertId%/g,t.advertId),n=this.$el.data("url").replace(/%advertId%/g,t.advertId);$.ajax({type:"DELETE",url:n,beforeSend:function(e){e.setRequestHeader("App-Access-Token",i)},error:function(e,t,i){throw new Error(t,i)},success:function(e){$(location).attr("href",s)}})}})},579:function(e,t,i){"use strict";var s=i(580),n=(i.n(s),i(581));t.a=n.a},580:function(e,t){},581:function(e,t,i){"use strict";var s=i(582),n=i(28),a=i(77),r=i(586);t.a=Backbone.View.extend({el:".js-productPage",events:{"click .js-sellerSiteLink":"sellerSiteLinkClick","ready .js-productPageMap":"activateAddressLink"},cssClasses:{clickable:"productPage__infoTextBold_clickable",infoBlockTable:"productPage__infoBlockTable",infoBlockRow:"productPage__infoBlockRow",infoBlockCell:"productPage__infoBlockCell",visible:"productPage__infoColumns_visible"},initialize:function(){var e=this.elements={$map:$(".js-productPageMap",this.el),$viewCounts:$(".js-view-count",this.el),$productPageTitle:$(".js-productPageTitle",this.el),$mapLink:$(".js-scrollToMap"),$infoBlockAuto:$(".js-productPage__characteristicsBlock",this.el)};this.initGallery(),this.initYandexMap(),this.initPopups(),this.initDescriptionCropper(),this.showServiceLinks(),this.showViewCounts(),this.addClassTitleFromHeigth(),this.formatAutoInfoBlock(),this.breakToColumns(),e.$map.length&&this.activateAddressLink()},initPopups:function(){var e=new s.a("/ajax/lnf/message_to_author.php",s.b);this.events["click .js-productWriteMessage"]=function(t){return t.preventDefault(),IRR.Tools.Pubsub.publish("productPage:writeMessageToOwner"),e.open(),!1}},initGallery:function(){var e=document.querySelector(".js-productGallery"),t=document.querySelector(".js-lineProductGallery");null!==e&&new a.a({element:e}),null!==t&&new r.a({element:t})},initDescriptionCropper:function(){var e=this.el.querySelector(".js-productPageDescription");null!==e&&new n.a({el:e,options:{toggleable:!0,toggleLinkClass:"productPage__readMore",toggleLinkText:{minimized:"Читать дальше",maximized:"Свернуть"}}})},initYandexMap:function(){var e=this;new IRR.App.YaMapsLazyLoad({cssSels:{lazy:".js-ymaps-lazy"},cssClss:{lazy:"js-ymaps-lazy"},precede:.2,immediate:!0}).ymaps.catch(function(){return e.deactivateAddressLink()})},showServiceLinks:function(){"googletag"in window&&googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(e){var t=e.slot.getSlotElementId();!e.isEmpty&&t.startsWith("Service.Link")&&$(document.getElementById(t)).parents().removeClass("hidden")})})},showViewCounts:function(){var e=this.elements.$viewCounts,t=100;!function i(){t--;var s=window.detailsCount;isNaN(s)?t>0&&setTimeout(i,100):e.html(""+s)}()},sellerSiteLinkClick:function(e){IRR.Tools.Pubsub.publish("productPage:sellerSite",{href:e.currentTarget.href})},activateAddressLink:function(){var e=this.elements;e.$mapLink.addClass(this.cssClasses.clickable).on("click",function(){$("html, body").animate({scrollTop:e.$map.offset().top-100})})},addClassTitleFromHeigth:function(){var e=this.elements.$productPageTitle,t=parseInt(e.css("line-height"),10);t&&e.addClass("productPage__title_lines_"+Math.floor(e.height()/t))},deactivateAddressLink:function(){this.elements.$mapLink.removeClass(this.cssClasses.clickable).off("click")},formatAutoInfoBlock:function(){var e,t,i,s=this.elements.$infoBlockAuto,n=this.cssClasses,a=!1;s.length&&(e=$(".productPage__characteristicsItem",s),e.each(function(e,t){if(0===e&&(i=t.offsetTop),t.offsetTop>i)return a=!0,!1}),a&&(s.addClass(n.infoBlockTable),e.each(function(e,i){e%3==0&&(t=$("<div>").addClass(n.infoBlockRow).appendTo(s)),$(i).addClass(n.infoBlockCell).appendTo(t)})))},breakToColumns:function(){var e=this.el.querySelector(".js-infoColumns");if(null!==e){var t=Array.prototype.slice.call(e.querySelectorAll(".js-columnBlock")),i=0,s=[],n=[],a=t.reduce(function(e,t){return e+t.offsetHeight},0)/2;t.forEach(function(e){s[i]=s[i]||0,s[i]+=e.offsetHeight,s[i]>a&&i++,n[i]=n[i]||[],n[i].push(e)});var r=Math.max.apply(Math,s),o=n.map(function(e){return'<div class="productPage__infoColumn">'+e.map(function(e){return e.outerHTML}).join("")+"</div>"}).join("");e.innerHTML=o,e.classList.add(this.cssClasses.visible),e.style.height=r+"px"}}})},582:function(e,t,i){"use strict";var s=i(583);i.d(t,"b",function(){return s.a});var n=i(585);i.d(t,"a",function(){return n.a})},583:function(e,t,i){"use strict";var s=i(584);t.a=s.a.extend({el:".js-productPageSendMessageForm",formSubmit:function(e){s.a.prototype.formSubmit.call(this,e),IRR.Tools.Pubsub.publish("productPage:messageSent")}})},584:function(e,t,i){"use strict";var s=i(70);t.a=Backbone.View.extend({events:{"submit .js-form":"formSubmit","change .js-input":"formInputChange","keyup .js-input":"formInputChange"},initialize:function(){this.elements={$formBlock:this.$(".js-form"),$successBlock:this.$(".js-success"),$errorBlock:this.$(".js-error"),$inputs:this.$(".js-input"),$submitButton:this.$(".js-submitButton"),$multiselect:this.$(".js-multiselect")},this.isLoading=!1,this.submitIsAvailable=!1,this.recaptchaRequired=!1,this.submitButtonOriginalText=this.elements.$submitButton.text(),this.checkSubmitAvailability(),this.updateFormState(),this.showForm(),this.hideError(),this.hideSuccess(),this.initRecaptcha(),this.elements.$multiselect.length>0&&this.multiSelect()},initRecaptcha:function(){var e=$(".js-recaptchaContainer",this.el);if(e.length){this.recaptchaRequired=!0;var t=$(".js-recaptcha",e),i=$(".js-input",e);this.recaptchaView=new IRR.Views.RecaptchaView({el:t,input:i})}},checkSubmitAvailability:function(){var e=!0;return this.elements.$inputs.each(function(t,i){var s=$(i);s.is(":required")&&!s.val()&&(e=!1)}),this.recaptchaRequired&&!0===e&&(e=this.recaptchaView.isConfirmed),e},reportValidity:function(){"reportValidity"in this.elements.$formBlock[0]?this.elements.$formBlock[0].reportValidity():$('button, [type="submit"]',this.el).click()},hideForm:function(){this.elements.$formBlock.hide()},showForm:function(){this.elements.$formBlock.show()},hideError:function(){this.elements.$errorBlock.hide()},showError:function(){this.elements.$errorBlock.show()},hideSuccess:function(){this.elements.$successBlock.hide()},showSuccess:function(){this.elements.$successBlock.show()},sendMessage:function(){var e=this,t=this.elements,i=t.$formBlock.serializeArray();i.push({name:"ad_id",value:IRR.App.Info.advertId}),this.setLoading(),$.ajax({url:t.$formBlock.attr("action"),type:"post",data:i,error:function(t,i,s){throw e.hideForm(),e.hideSuccess(),e.showError(),new Error("ProductPagePopupFormView ajax error: "+i+" "+s)},success:function(i){if(i.result)e.hideForm(),e.hideError(),e.showSuccess();else if(0!=_.keys(i.errors).length){var s=0;if(i.errors.forEach(function(e){_.keys(e).forEach(function(i){var n=t.$inputs.filter('[name="'+i+'"]');n.length?n[0].setCustomValidity(e[i].join(",")):s++})}),s)throw e.hideForm(),e.hideSuccess(),e.showError(),new Error("ProductPagePopupFormView errors: "+JSON.stringify(i));e.reportValidity()}else e.hideForm(),e.hideSuccess(),e.showError()},complete:function(){e.clearLoading()}})},setLoading:function(){this.isLoading=!0,this.updateFormState()},clearLoading:function(){this.isLoading=!1,this.updateFormState()},updateFormState:function(){var e=this.elements;this.isLoading?(e.$submitButton.attr("disabled","disabled"),e.$submitButton.text("Загрузка")):this.submitIsAvailable?(e.$submitButton.removeAttr("disabled"),e.$submitButton.text(this.submitButtonOriginalText)):e.$submitButton.attr("disabled","disabled")},formSubmit:function(e){return e.preventDefault(),!(this.isLoading||!this.submitIsAvailable)&&(this.sendMessage(),!1)},formInputChange:function(e){e.target.setCustomValidity(""),this.submitIsAvailable=this.checkSubmitAvailability(),this.updateFormState()},destroy:function(){this.unbind(),this.remove()},multiSelect:function(){new s.a({el:this.elements.$multiselect})}})},585:function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(){function e(t,i){var n=this;if(s(this,e),!t)throw new Error("ProductPagePopupForm error: no template URL specified");if(!i)throw new Error("ProductPagePopupForm error: no backboneView specified");this.templateUrl=t,this.BackboneViewPrototype=i,this.advertId=IRR.App.Info.advertId,this.backboneView=null,this.modal=new IrrModalPrototype,this.modal.modalOptions.position="middle",this.modal.on("afterClose",function(){n.backboneView&&(n.backboneView.destroy(),n.backboneView=null)})}return n(e,[{key:"getHtml",value:function(){var e=this;return new Promise(function(t,i){$.ajax({url:e.templateUrl,cache:!1,data:{id:e.advertId},error:function(e,t,s){i("ProductPagePopupForm ajax error: "+t+" "+s)},success:function(i){e.html=i,t(e.html)}})})}},{key:"setContent",value:function(){var e=this;this.getHtml().then(function(t){e.modal.setContent(t),e.backboneView=new e.BackboneViewPrototype},function(e){throw new Error(e)})}},{key:"open",value:function(){this.modal.setLoading(),this.modal.open(),this.setContent()}},{key:"close",value:function(){this.modal.close()}}]),e}();t.a=a},586:function(e,t,i){"use strict";function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=i(77),r=i(587),o=(i.n(r),function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}()),l=function e(t,i,s){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};n(this,e),this.imageUrl=t,this.previewUrl=i,this.title=s,this.isLoaded=!1,this.active=!1,this.width=0,this.isMap=a,this.mapInfo=r},c=function(){function e(){n(this,e),this.images=[]}return o(e,[{key:"addImage",value:function(e,t,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.images.push(new l(e,t,i,s,n))}},{key:"length",value:function(){return this.images.length}},{key:"each",value:function(e){return this.images.forEach(e)}},{key:"getByIndex",value:function(e){return this.images[e]}},{key:"setActive",value:function(e){this.images.forEach(function(e){e.active=!1}),this.images[e].active=!0}},{key:"setWidth",value:function(e,t){this.images[e].width=t}},{key:"getActiveIndex",value:function(){return this.images.findIndex(function(e){return e.active})}}]),e}();t.a=Backbone.View.extend({initialize:function(){var e;if(!this.options.element)throw new Error("ProductGalleryLineView error: No gallery element specified.");this.setElement(this.options.element),this.fullScreenInstance=null,this.slideInProgress=!1,this.slideInProgressClearTimer=null,this.elementClass="lineGallery",this.classList={blocks:{imagesContainer:this.elementClass+"__imagesContainer",imagesContainerAnimated:this.elementClass+"__imagesContainer_animated",imageItem:this.elementClass+"__imageItem",image:this.elementClass+"__image",nav:this.elementClass+"__nav",control:this.elementClass+"__control",controlIcon:this.elementClass+"__icon",yMap:this.elementClass+"__yMap",jsYMap:"js-"+this.elementClass+"__yMap"},modifiers:{imagesContainerMap:this.elementClass+"__imagesContainer_map",controlNextImage:this.elementClass+"__control_nextImage",controlNextImageShown:this.elementClass+"__control_nextImage_shown",controlNextImageRewind:this.elementClass+"__control_nextImage_rewind",controlPrevImage:this.elementClass+"__control_prevImage",controlPrevImageShown:this.elementClass+"__control_prevImage_shown",controlPrevImageDisabled:this.elementClass+"__control_prevImage_disabled",imageItemMap:this.elementClass+"__imageItem_map",imageItemFail:this.elementClass+"__imageItem_fail",imageShown:this.elementClass+"__image_shown",imageItemIsMap:this.elementClass+"__imageItem_isMap",controlIconNext:this.elementClass+"__icon_next",controlIconRewind:this.elementClass+"__icon_rewind"}},this.settings={loadingWidth:360,slideImages:3},this.elementWidth=this.el.offsetWidth,this.totalImagesWidth=0,this.currentIndex=0,this.currentSlide=0,this.elements={},this.events=(e={},s(e,"click ."+this.classList.blocks.imageItem,"onImageItemClick"),s(e,"click ."+this.classList.modifiers.controlNextImage,"onNextImageClick"),s(e,"click ."+this.classList.modifiers.controlPrevImage,"onPrevImageClick"),s(e,"transitionend ."+this.classList.blocks.imagesContainer,"onTransitionEnd"),e),$(window).on("resize",this.onResize.bind(this)),this.startGallery()},updateNav:function(){this.toggleNav(this.totalImagesWidth>this.elementWidth),this.updateNavState()},updateNavState:function(){this.elements.prevImage.classList.toggle(this.classList.modifiers.controlPrevImageDisabled,!this.canslideLeft()),this.elements.nextImage.classList.toggle(this.classList.modifiers.controlNextImageRewind,!this.canslideRight())},onResize:function(){this.elementWidth=this.el.offsetWidth,this.updatePosition(),this.updateNav()},updateTotalImagesWidth:function(){var e=this;this.totalImagesWidth=0,this.imageStorage.each(function(t){e.totalImagesWidth+=t.width||e.settings.loadingWidth}),this.updateNav()},getXTransformForImage:function(e){var t=this,i=0;return this.imageStorage.each(function(s,n){var a=s.width||t.settings.loadingWidth;n<e&&(i+=a)}),i},toggleNav:function(e){this.elements.nextImage.classList.toggle(this.classList.modifiers.controlNextImageShown,e),this.elements.prevImage.classList.toggle(this.classList.modifiers.controlPrevImageShown,e)},updatePosition:function(){this.slideToX(this.getXTransformForImage(this.currentIndex))},getMaxX:function(){return Math.max(this.totalImagesWidth-this.elementWidth,0)},canSlideToX:function(e){return e<=this.getMaxX()},canslideLeft:function(){return this.currentSlide>0},canslideRight:function(){return this.currentSlide<this.getMaxX()},slideToX:function(e){e=this.canSlideToX(e)?e:this.getMaxX(),this.elements.imagesContainer.style.transform="translate3d(-"+e+"px, 0, 0)",this.currentSlide=e,this.updateNavState()},onImageItemClick:function(e){this.imageStorage.setActive(e.currentTarget.dataset.index),this.fullScreenInstance.openFullScreen()},slideLeft:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.canslideLeft()&&this.slideToIndex(e?0:Math.max(this.currentIndex-this.settings.slideImages,0))},slideRight:function(){if(!this.canslideRight())return this.slideLeft(!0);var e=Math.min(this.currentIndex+this.settings.slideImages,this.imageStorage.length()-1),t=this.canSlideToX(this.getXTransformForImage(e))?e:this.currentIndex;t<e?(this.animate(),this.slideToX(this.getMaxX())):this.slideToIndex(t)},onNextImageClick:function(e){e.preventDefault(),this.slideRight()},onPrevImageClick:function(e){e.preventDefault(),this.slideLeft()},slideToIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentIndex=e,this.animate(),this.updatePosition()},toggleAnimation:function(e){this.elements.imagesContainer.classList.toggle(this.classList.blocks.imagesContainerAnimated,e)},animate:function(){this.toggleAnimation(!0)},deanimate:function(){this.toggleAnimation(!1)},onTransitionEnd:function(){this.deanimate()},startGallery:function(){this.parseImages(),this.addWrapper(),this.renderImages(),this.loadAllImages(),this.renderNav(),this.createFullScreenInstance()},getYandexMapInfo:function(){var e,t=document.querySelector(".js-productPageMap");if(null===t)return null;try{e=JSON.parse(t.dataset.mapInfo)}catch(e){return console.error(e),null}return e},generateYMapImage:function(e,t){var i=t?650:360,s="https://static-maps.yandex.ru/1.x/?ll="+e.lng+","+e.lat+"&size="+i+",270&z=16&l=map";return{src:s,preview:s,alt:e.hint||""}},parseImages:function(){var e,t=this,i=this.el.querySelectorAll("img"),s=this.getYandexMapInfo();this.imageStorage=new c,s&&(e=this.generateYMapImage(s,0===i.length),this.imageStorage.addImage(e.src,e.preview,e.alt,!0,s)),Array.prototype.forEach.call(i,function(e){t.imageStorage.addImage(e.getAttribute("data-src"),e.getAttribute("data-preview"),e.alt),t.el.removeChild(e)})},addWrapper:function(){this.el.insertAdjacentHTML("beforeend",'<ul class="'+this.classList.blocks.imagesContainer+'"></ul>'),this.elements.imagesContainer=this.el.querySelector("."+this.classList.blocks.imagesContainer)},renderNav:function(){var e=this.classList.blocks.control,t=this.classList.blocks.controlIcon,i=this.classList.modifiers.controlNextImage,s=this.classList.modifiers.controlPrevImage,n=this.classList.modifiers.controlIconNext,a=this.classList.modifiers.controlIconRewind;this.el.insertAdjacentHTML("beforeend",'<a class="'+e+" "+i+'" data-action="nextImage" title="Следующее изображение"><span class="'+t+" "+n+'"><i class="icon icon_arrowRight"></i></span><span class="'+t+" "+a+'"><i class="icon icon_rewind"></i></span></a>'),this.el.insertAdjacentHTML("beforeend",'<a class="'+e+" "+s+'" data-action="prevImage" title="Предыдущее изображение"><i class="icon icon_arrowLeft"></a>'),this.elements.nextImage=this.el.querySelector("."+i),this.elements.prevImage=this.el.querySelector("."+s)},renderImages:function(){var e=this,t="";this.imageStorage.each(function(i,s){t+='<li class="'+e.classList.blocks.imageItem+'" style="min-width: '+e.settings.loadingWidth+'px" data-index="'+s+'"><img class="'+e.classList.blocks.image+'" src="" alt="'+i.title+'" /></li>'}),this.elements.imagesContainer.innerHTML=t},loadImage:function(e){var t=this,i=parseInt(e.getAttribute("data-index")),s=this.imageStorage.getByIndex(i),n=e.querySelector("img"),a=e.querySelector("."+this.classList.blocks.yMap);if(!s.isLoaded){if(s.isMap&&1===this.imageStorage.length())return e.classList.add(this.classList.modifiers.imageItemMap),this.elements.imagesContainer.classList.add(this.classList.modifiers.imagesContainerMap),null!==n&&e.removeChild(n),null===a&&(a=document.createElement("div"),a.classList.add(this.classList.blocks.yMap),a.classList.add(this.classList.blocks.jsYMap),e.appendChild(a)),void this.renderMap(s.mapInfo,a);var r=document.createElement("img");r.onload=function(){n.src=s.imageUrl,e.style.minWidth=0,t.imageStorage.setWidth(i,n.offsetWidth),t.updateTotalImagesWidth(),t.updatePosition(),t.forceRedraw(),n.classList.add(t.classList.modifiers.imageShown),s.isMap&&e.classList.add(t.classList.modifiers.imageItemIsMap),r.remove()},r.onerror=function(){e.classList.add(t.classList.modifiers.imageItemFail),r.remove()},r.src=s.imageUrl}},renderMap:function(e,t){var i=this;IRR.Tools.Maps.getYmaps(e).then(function(s){var n=window.staticHost||"/site",a=n+"/pic_dis/mapIcon.png";i.elements.yMap&&i.elements.yMap.destroy(),t.innerHTML="",i.elements.yMap=new s.Map(t,{center:[e.lat,e.lng],zoom:e.zoom,controls:[]},{suppressMapOpenBlock:!0});var r=e.hint?{hintContent:e.hint}:{};i.elements.yMap.behaviors.disable(["drag","rightMouseButtonMagnifier","scrollZoom"]),i.elements.yMap.geoObjects.add(new s.Placemark([e.lat,e.lng],r,{iconLayout:"default#image",iconImageHref:a,iconImageSize:[33,45],iconImageOffset:[-16,-45],cursor:"grab"}))})},loadAllImages:function(){var e=this,t=this.el.querySelectorAll("li");Array.prototype.forEach.call(t,function(t){e.loadImage(t)})},forceRedraw:function(){return this.el.offsetHeight},createFullScreenInstance:function(){var e=document.createElement("div");e.setAttribute("tabindex","100"),this.elements.fullScreenElement=document.body.appendChild(e),this.fullScreenInstance=new a.a({element:this.elements.fullScreenElement,isFullScreen:!0,imageStorage:this.imageStorage}),this.fullScreenInstance.on("fullScreenCloseEvent",this.onFullScreenClose.bind(this)),e.classList.add(this.fullScreenInstance.elementClass),e.classList.add(this.fullScreenInstance.classList.modifiers.fullScreen),e.classList.add(this.fullScreenInstance.classList.modifiers.fullScreenClosed)},onFullScreenClose:function(){}})},587:function(e,t){},588:function(e,t,i){"use strict";var s=i(589),n=(i.n(s),i(590));i.d(t,"a",function(){return n.a})},589:function(e,t){},590:function(e,t,i){"use strict";t.a=Backbone.View.extend({el:".js-schedule",initialize:function(){this.el&&this.setSchedule()},setSchedule:function(){for(var e=this.el.getAttribute("data-stat"),t=JSON.parse(e),i=(t.reduce(function(e,t){return e+t},0),""),s=Math.max.apply(null,t),n=0;n<t.length;n++){var a=t[n];i+='<p class="statistic__column" style="height: '+Math.ceil(100*a/s)+'%"><span>'+a+"</span></p>"}this.el.insertAdjacentHTML("beforeEnd",i)}})},591:function(e,t,i){"use strict";var s=i(592);$(function(){new s.a;var e=document.querySelector(".js-listingTitleWrapper"),t=document.querySelector(".js-sidebar");if(e){var i=e.getBoundingClientRect().height;t.style.paddingTop=i+"px"}})},592:function(e,t,i){"use strict";var s=i(28),n=i(593);i.n(n);t.a=Backbone.View.extend({el:".js-housingComplex",initialize:function(){var e=document.querySelector('.js-backendVar[name="idHousingComplex"]');null==e&&void 0==e||(this.template=_.template(document.getElementById("housingComplex-template").innerHTML),this.id=e.value,this.getInfo())},getInfo:function(){var e=this;$.ajax({url:"/ajax/housing_complexes/description_housing_complex.php",type:"POST",data:JSON.stringify({id:this.id}),success:function(t){t.status&&(e.printHousingComplex(t),e.cropListingProductNames())},error:function(){console.error("Housing Complex: произошла ошибка")}})},printHousingComplex:function(e){var t=this.template(e.data);this.el.insertAdjacentHTML("beforeEnd",t)},cropListingProductNames:function(){$(".js-houseComplexDescription",this.el).each(function(e,t){t.getAttribute("data-cropped")||(new s.a({el:t,options:{toggleable:!1,maxLines:4}}),t.setAttribute("data-cropped",!0))})}})},593:function(e,t){},77:function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=i(125),a=i.n(n),r=i(126),o=(i.n(r),function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}()),l=function(){function e(){s(this,e),this.images=[]}return o(e,[{key:"addImage",value:function(e,t,i){this.images.push(new c(e,t,i))}},{key:"length",value:function(){return this.images.length}},{key:"each",value:function(e){return this.images.forEach(e)}},{key:"getByIndex",value:function(e){return this.images[e]}},{key:"setActive",value:function(e){this.images.forEach(function(e){e.active=!1}),this.images[e].active=!0}},{key:"getActiveIndex",value:function(){return this.images.findIndex(function(e){return e.active})}}]),e}(),c=function e(t,i,n){s(this,e),this.imageUrl=t,this.previewUrl=i,this.title=n,this.isLoaded=!1,this.active=!1},h=Backbone.View.extend({initialize:function(){var e=this;if(!this.options.element)throw new Error("ProductGalleryView error: No gallery element specified.");this.isFullScreen="isFullScreen"in this.options&&this.options.isFullScreen,this.fullScreenInstance=null,this.maxImagesCount=10,this.setElement(this.options.element),this.slideInProgress=!1,this.slideInProgressClearTimer=null,this.elements={},this.events={keydown:"keyDownEvent"},this.elementClass="productGallery",this.classList={blocks:{main:this.elementClass+"__main",viewport:this.elementClass+"__viewport",nav:this.elementClass+"__nav",navLink:this.elementClass+"__navLink",image:this.elementClass+"__image",control:this.elementClass+"__control",yDirect:this.elementClass+"__yDirect",wrapper:this.elementClass+"__wrapper",yMap:this.elementClass+"__yMap",jsYMap:"js-"+this.elementClass+"__yMap"},modifiers:{loading:this.elementClass+"_loading",imageLoading:this.elementClass+"__image_loading",fullScreen:this.elementClass+"_fullScreen",fullScreenClosed:this.elementClass+"_fullScreenClosed",fastTransition:this.elementClass+"_fastTransition",navLinkActive:this.elementClass+"__navLink_active",controlFullScreen:this.elementClass+"__control_fullScreen",controlNextImage:this.elementClass+"__control_nextImage",controlPrevImage:this.elementClass+"__control_prevImage",overflowHidden:this.elementClass+"_overflowHidden"}},this.events["click ."+this.classList.blocks.control]="controlClick",this.events["click ."+this.classList.blocks.navLink]="navLinkClick",this.events["click ."+this.classList.blocks.image+" img"]="imageLinkClick",this.events["click ."+this.classList.blocks.jsYMap]="yMapClick",this.isFullScreen?(this.imageStorage=this.options.imageStorage,this.renderGallery(),this.renderImages(),this.loadImage(this.elements.viewport.firstChild),this.events.click="fullScreenOverlayClick",$(window).on("resize",function(){var t=e.elements.viewport.clientHeight;Array.prototype.forEach.call(e.elements.viewport.childNodes,function(e){e.style.height=t+"px"})}),$(window).trigger("resize")):(this.imageStorage=new l,this.parseImages(),this.renderGallery(),this.renderImages(),this.loadImage(this.elements.viewport.firstChild),this.el.classList.remove(this.classList.modifiers.loading),this.createFullScreenInstance(),this.options.active||this.syncNav()),a()()},createFullScreenInstance:function(){var e=this,t=document.createElement("div");t.classList.add(this.elementClass),t.classList.add(this.classList.modifiers.fullScreen),t.classList.add(this.classList.modifiers.fullScreenClosed),t.setAttribute("tabindex","100"),this.elements.fullScreenElement=document.body.appendChild(t),this.fullScreenInstance=new h({element:this.elements.fullScreenElement,isFullScreen:!0,imageStorage:this.imageStorage}),this.fullScreenInstance.on("fullScreenCloseEvent",function(){e.showActiveImageInViewport(),e.syncNav()})},parseImages:function(){var e=this,t=this.el.querySelectorAll("img");Array.prototype.forEach.call(t,function(t){e.imageStorage.addImage(t.getAttribute("data-src"),t.getAttribute("data-preview"),t.alt),e.el.removeChild(t)})},renderGallery:function(){this.el.insertAdjacentHTML("beforeend",'<div class="'+this.classList.blocks.wrapper+'"></div>'),this.elements.wrapper=this.el.querySelector("."+this.classList.blocks.wrapper),this.elements.wrapper.insertAdjacentHTML("beforeend",'<div class="'+this.classList.blocks.main+'"></div>'),this.elements.main=this.el.querySelector("."+this.classList.blocks.main),this.elements.main.insertAdjacentHTML("beforeend",'<div class="'+this.classList.blocks.viewport+'"></div>'),this.elements.viewport=this.el.querySelector("."+this.classList.blocks.viewport),
this.isFullScreen?(this.elements.main.insertAdjacentHTML("beforeend",'<a class="'+this.classList.blocks.control+" "+this.classList.modifiers.controlFullScreen+'" data-action="fullScreen" title="Свернуть полноэкранный режим"><i class="icon icon_cancel"></a>'),this.elements.main.insertAdjacentHTML("beforeend",'<div class="'+this.classList.blocks.yDirect+'"></div>'),this.elements.yDirect=this.el.querySelector("."+this.classList.blocks.yDirect),this.elements.yDirectGallery=$(".js-yandexDirectGallery"),this.elements.yDirectGallery.appendTo(this.elements.yDirect).wrap('<div id="productListingYandexDirect" class="yandexDirect"></div>')):this.elements.main.insertAdjacentHTML("beforeend",'<a class="'+this.classList.blocks.control+" "+this.classList.modifiers.controlFullScreen+'" data-action="fullScreen" title="Полноэкранный режим"><i class="icon icon_fullscreen"></a>'),this.elements.fullScreenControl=this.el.querySelector("."+this.classList.modifiers.controlFullScreen),this.imageStorage.length()>1&&(this.elements.wrapper.insertAdjacentHTML("beforeend",'<div class="'+this.classList.blocks.nav+'"></div>'),this.elements.nav=this.el.querySelector("."+this.classList.blocks.nav),this.elements.main.insertAdjacentHTML("beforeend",'<a class="'+this.classList.blocks.control+" "+this.classList.modifiers.controlNextImage+'" data-action="nextImage" title="Следующее изображение"><i class="icon icon_arrowRight"></a>'),this.elements.main.insertAdjacentHTML("beforeend",'<a class="'+this.classList.blocks.control+" "+this.classList.modifiers.controlPrevImage+'" data-action="prevImage" title="Предыдущее изображение"><i class="icon icon_arrowLeft"></a>'),this.elements.nextImageControl=this.el.querySelector("."+this.classList.modifiers.controlFullScreen),this.elements.prevImageControl=this.el.querySelector("."+this.classList.modifiers.controlFullScreen))},renderImages:function(){var e=this,t="",i="",s=this.imageStorage.length();this.imageStorage.each(function(s,n){var a=s.isLoaded?s.imageUrl:"",r=s.isLoaded?"":e.classList.modifiers.imageLoading;t+='<div class="'+e.classList.blocks.image+" "+r+'" data-index="'+n+'"><img src="'+a+'" alt="'+s.title+'"/></div>',i+='<a class="'+e.classList.blocks.navLink+'" style="background-image: url(\''+s.previewUrl+'\');" data-index="'+n+'"></a>'}),this.elements.viewport.innerHTML=t,s>1&&(this.elements.nav.innerHTML=i)},renderDirect:function(){var e={ad_format:"direct",favicon:!1,font_size:1,header_bg_color:"E6E6E6",hover_color:"494949",limit:1,no_sitelink:!1,site_bg_color:"FFFFFF",text_color:"0",title_color:"494949",title_font_size:2,url_color:"BCBCBC"},t=IRR.Tools.guid(),i=this.elements.yDirectGallery;e=Object.assign(e,i.data("directParams")),i.empty().attr("id",t),IRR.Tools.YaDirect.getYaDirect().then(function(i){return i.insertInto(e.partner_id,t,e)})},controlClick:function(e){var t=this;switch(e.preventDefault(),e.stopPropagation(),e.currentTarget.getAttribute("data-action")){case"nextImage":this.slideInProgress||this.slideLeft().then(function(){t.loadImage(t.elements.viewport.firstChild)});break;case"prevImage":this.slideInProgress||this.slideRight().then(function(){t.loadImage(t.elements.viewport.firstChild)});break;case"fullScreen":this.isFullScreen?this.closeFullScreen():this.fullScreenInstance.openFullScreen()}return!1},navLinkClick:function(e){var t=e.currentTarget,i=t.getAttribute("data-index"),s=null,n=null,a=null;return e.preventDefault(),e.stopPropagation(),Array.prototype.forEach.call(this.elements.viewport.childNodes,function(e,t){e.getAttribute("data-index")===i&&(s=e,n=t)}),a=n+1>this.elements.viewport.childNodes.length/2?"right":"left",this.elements.viewport.classList.add(this.classList.modifiers.fastTransition),this.slideToIndex(i,a),!1},imageLinkClick:function(e){var t=this;return e.preventDefault(),e.stopPropagation(),e.offsetX<e.target.offsetWidth/2?this.slideInProgress||this.slideRight().then(function(){t.loadImage(t.elements.viewport.firstChild)}):this.slideInProgress||this.slideLeft().then(function(){t.loadImage(t.elements.viewport.firstChild)}),!1},yMapClick:function(e){e.stopPropagation()},fullScreenOverlayClick:function(){this.isFullScreen&&this.closeFullScreen()},keyDownEvent:function(e){var t=this;if(~[37,39,27].indexOf(e.keyCode)){switch(e.preventDefault(),e.keyCode){case 37:this.slideInProgress||this.slideRight().then(function(){t.loadImage(t.elements.viewport.firstChild)});break;case 39:this.slideInProgress||this.slideLeft().then(function(){t.loadImage(t.elements.viewport.firstChild)});break;case 27:this.isFullScreen&&this.closeFullScreen()}return!1}},loadImage:function(e){var t=this,i=parseInt(e.getAttribute("data-index")),s=this.imageStorage.getByIndex(i),n=e.querySelector("img"),a=e.querySelector("."+this.classList.blocks.yMap);if(s.isMap)return null!==n&&e.removeChild(n),null===a&&(a=document.createElement("div"),a.classList.add(this.classList.blocks.yMap),a.classList.add(this.classList.blocks.jsYMap),e.appendChild(a)),void this.renderMap(s.mapInfo,a);if(!s.isLoaded){var r=document.createElement("img");r.onload=function(){n.src=s.imageUrl,t.el.offsetHeight,e.classList.remove(t.classList.modifiers.imageLoading),n.setAttribute("style","min-width:"+n.width+"; min-height:"+n.height+"; font-family: 'object-fit: contain'"),r.remove()},r.src=s.imageUrl}},renderMap:function(e,t){var i=this;IRR.Tools.Maps.getYmaps(e).then(function(s){var n=window.staticHost||"/site",a=n+"/pic_dis/mapIcon.png";i.elements.yMap&&i.elements.yMap.destroy(),t.innerHTML="",i.elements.yMap=new s.Map(t,{center:[e.lat,e.lng],zoom:e.zoom,controls:["rulerControl"]}),i.elements.yMap.controls.add(new s.control.ZoomControl({options:{position:{top:10,left:10}}}));var r=e.hint?{hintContent:e.hint}:{};i.elements.yMap.geoObjects.add(new s.Placemark([e.lat,e.lng],r,{iconLayout:"default#image",iconImageHref:a,iconImageSize:[33,45],iconImageOffset:[-16,-45],cursor:"grab"}))})},slideToIndex:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";if(this.elements.viewport.firstChild.getAttribute("data-index")==e)return this.loadImage(this.elements.viewport.firstChild),void this.elements.viewport.classList.remove(this.classList.modifiers.fastTransition);switch(i){case"left":this.slideLeft().then(function(){t.slideToIndex(e,i)});break;case"right":this.slideRight().then(function(){t.slideToIndex(e,i)})}},slideLeft:function(){var e=this,t=this.elements.viewport.firstChild;return new Promise(function(i,s){if(e.imageStorage.length()<=1)return void i();if(IRR.clientInfo.transitionSupport){e.setSlideInProgressTimer(),e.slideInProgress=!0;var n=function s(n){n.target.removeEventListener(IRR.clientInfo.transitionEndEvent,s);var a=t.cloneNode(!0);a.style.marginLeft="0",e.elements.viewport.removeChild(t),e.elements.viewport.appendChild(a),e.slideInProgress=!1,e.syncNav(),e.clearSlideInProgressTimer(),i()};t.addEventListener(IRR.clientInfo.transitionEndEvent,n);var a=-1*t.clientWidth;t.style.marginLeft=a+"px"}else{var r=t.cloneNode(!0);e.elements.viewport.appendChild(r),e.elements.viewport.removeChild(t),e.syncNav(),i()}})},slideRight:function(){var e=this,t=this.elements.viewport.lastChild;return new Promise(function(i,s){if(e.imageStorage.length()<=1)return void i();if(IRR.clientInfo.transitionSupport){e.setSlideInProgressTimer(),e.slideInProgress=!0;var n=t.cloneNode(!0),a=-1*t.clientWidth;n.style.marginLeft=a+"px",e.elements.viewport.removeChild(t);var r=function t(s){s.target.removeEventListener(IRR.clientInfo.transitionEndEvent,t),e.slideInProgress=!1,e.syncNav(),e.clearSlideInProgressTimer(),i()};n.addEventListener(IRR.clientInfo.transitionEndEvent,r),e.elements.viewport.insertBefore(n,e.elements.viewport.firstChild),e.el.offsetHeight,e.elements.viewport.firstChild.style.marginLeft="0"}else{var n=t.cloneNode(!0);e.elements.viewport.insertBefore(n,e.elements.viewport.firstChild),e.elements.viewport.removeChild(t),e.syncNav(),resovle()}})},syncNav:function(){var e=this;if(!(this.imageStorage.length()<=1)){var t=parseInt(this.elements.viewport.firstChild.getAttribute("data-index"));this.imageStorage.setActive(t),Array.prototype.forEach.call(this.elements.nav.childNodes,function(i){parseInt(i.getAttribute("data-index"))==t?i.classList.add(e.classList.modifiers.navLinkActive):i.classList.remove(e.classList.modifiers.navLinkActive)})}},showActiveImageInViewport:function(){var e=this;if(!(this.imageStorage.length()<=1)){var t=this.imageStorage.getActiveIndex(),i="";!function s(){var n=e.elements.viewport.firstChild,a=parseInt(n.getAttribute("data-index"));t!=a?(i+=n.outerHTML,e.elements.viewport.removeChild(n),s()):(e.elements.viewport.insertAdjacentHTML("beforeend",i),e.loadImage(n))}()}},setSlideInProgressTimer:function(){var e=this;null!==this.slideInProgressClearTimer&&this.clearSlideInProgressTimer(),this.slideInProgressClearTimer=setTimeout(function(){e.slideInProgress=!1},1e3)},clearSlideInProgressTimer:function(){clearTimeout(this.slideInProgressClearTimer),this.slideInProgressClearTimer=null},closeFullScreen:function(){document.body.classList.remove(this.classList.modifiers.overflowHidden),this.el.classList.add(this.classList.modifiers.fullScreenClosed),this.elements.yDirectGallery.css("display","none"),this.trigger("fullScreenCloseEvent")},openFullScreen:function(){document.body.classList.add(this.classList.modifiers.overflowHidden),this.el.classList.remove(this.classList.modifiers.fullScreenClosed),this.showActiveImageInViewport(),this.syncNav(),this.el.focus(),this.renderDirect(),this.elements.yDirectGallery.css("display","block"),$(window).trigger("resize"),this.elements.yMap&&this.elements.yMap.container.fitToViewport()}});t.a=h}},[569]);